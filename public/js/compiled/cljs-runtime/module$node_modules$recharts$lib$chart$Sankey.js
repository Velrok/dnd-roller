shadow$provide.module$node_modules$recharts$lib$chart$Sankey=function(global,require,module,exports){function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};desc.get||desc.set?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}newObj.default=obj;return newObj}function _interopRequireDefault(obj){return obj&&
obj.__esModule?obj:{default:obj}}function _typeof(obj$jscomp$0){_typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"===typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};return _typeof(obj$jscomp$0)}function _objectWithoutProperties(source,excluded){if(null==source)return{};if(null==source)var target={};else{target={};var sourceKeys=Object.keys(source),i;for(i=0;i<sourceKeys.length;i++){var key=
sourceKeys[i];0<=excluded.indexOf(key)||(target[key]=source[key])}}if(Object.getOwnPropertySymbols)for(i=Object.getOwnPropertySymbols(source),key=0;key<i.length;key++)sourceKeys=i[key],0<=excluded.indexOf(sourceKeys)||Object.prototype.propertyIsEnumerable.call(source,sourceKeys)&&(target[sourceKeys]=source[sourceKeys]);return target}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i],key;for(key in source)Object.prototype.hasOwnProperty.call(source,
key)&&(target[key]=source[key])}return target};return _extends.apply(this,arguments)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;"value"in descriptor&&(descriptor.writable=!0);Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){protoProps&&_defineProperties(Constructor.prototype,protoProps);staticProps&&_defineProperties(Constructor,
staticProps);return Constructor}function _getPrototypeOf(o$jscomp$0){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o$jscomp$0)}function _inherits(subClass,superClass){if("function"!==typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}});
superClass&&_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o$jscomp$0,p$jscomp$0){_setPrototypeOf=Object.setPrototypeOf||function(o,p){o.__proto__=p;return o};return _setPrototypeOf(o$jscomp$0,p$jscomp$0)}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"===typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,
sym).enumerable})));ownKeys.forEach(function(key){var value=source[key];key in target?Object.defineProperty(target,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):target[key]=value})}return target}Object.defineProperty(exports,"__esModule",{value:!0});exports.default=void 0;var _isFunction2=_interopRequireDefault(require("module$node_modules$lodash$isFunction")),_sumBy2=_interopRequireDefault(require("module$node_modules$lodash$sumBy")),_min2=_interopRequireDefault(require("module$node_modules$lodash$min")),
_maxBy2=_interopRequireDefault(require("module$node_modules$lodash$maxBy")),_react=_interopRequireWildcard(require("module$node_modules$react$index"));global=_interopRequireDefault(require("module$node_modules$prop_types$index"));var _classnames=_interopRequireDefault(require("module$node_modules$classnames$index")),_Surface=_interopRequireDefault(require("module$node_modules$recharts$lib$container$Surface")),_Layer=_interopRequireDefault(require("module$node_modules$recharts$lib$container$Layer")),
_Tooltip=_interopRequireDefault(require("module$node_modules$recharts$lib$component$Tooltip")),_Rectangle=_interopRequireDefault(require("module$node_modules$recharts$lib$shape$Rectangle")),_PureRender=_interopRequireWildcard(require("module$node_modules$recharts$lib$util$PureRender")),_ReactUtils=require("module$node_modules$recharts$lib$util$ReactUtils"),_ChartUtils=require("module$node_modules$recharts$lib$util$ChartUtils"),_class,_class2,_temp,defaultCoordinateOfTooltip={x:0,y:0},interpolationGenerator=
function(a,b){var ka=+a,kb=b-ka;return function(t){return ka+kb*t}},centerY=function(node){return node.y+node.dy/2},getValue=function(entry){return entry&&entry.value||0},getSumOfIds=function(links,ids){return ids.reduce(function(result,id){return result+getValue(links[id])},0)},getSumWithWeightedSource=function(tree,links,ids){return ids.reduce(function(result,id){return result+centerY(tree[links[id].source])*getValue(links[id])},0)},getSumWithWeightedTarget=function(tree,links,ids){return ids.reduce(function(result,
id){return result+centerY(tree[links[id].target])*getValue(links[id])},0)},ascendingY=function(a,b){return a.y-b.y},updateDepthOfTargets=function updateDepthOfTargets(tree,curNode){for(var targetNodes=curNode.targetNodes,i=0,len=targetNodes.length;i<len;i++){var target=tree[targetNodes[i]];target&&(target.depth=Math.max(curNode.depth+1,target.depth),updateDepthOfTargets(tree,target))}},getNodesTree=function(_ref,width,nodeWidth){var links=_ref.links;_ref=_ref.nodes.map(function(entry,index){for(var sourceNodes=
[],sourceLinks=[],targetNodes=[],targetLinks=[],i=0,len=links.length;i<len;i++){var link=links[i];link.source===index&&(targetNodes.push(link.target),targetLinks.push(i));link.target===index&&(sourceNodes.push(link.source),sourceLinks.push(i))}index={sourceNodes:sourceNodes,sourceLinks:sourceLinks,targetLinks:targetLinks,targetNodes:targetNodes};return _objectSpread({},entry,index,{value:Math.max(getSumOfIds(links,index.sourceLinks),getSumOfIds(links,index.targetLinks)),depth:0})});for(var i$jscomp$0=
0,len$jscomp$0=_ref.length;i$jscomp$0<len$jscomp$0;i$jscomp$0++){var node=_ref[i$jscomp$0];node.sourceNodes.length||updateDepthOfTargets(_ref,node)}i$jscomp$0=(0,_maxBy2.default)(_ref,function(entry){return entry.depth}).depth;if(1<=i$jscomp$0)for(width=(width-nodeWidth)/i$jscomp$0,len$jscomp$0=0,node=_ref.length;len$jscomp$0<node;len$jscomp$0++){var _node=_ref[len$jscomp$0];_node.targetNodes.length||(_node.depth=i$jscomp$0);_node.x=_node.depth*width;_node.dx=nodeWidth}return{tree:_ref,maxDepth:i$jscomp$0}},
updateYOfTree=function(depthTree,height,nodePadding,links){for(var yRatio=(0,_min2.default)(depthTree.map(function(nodes){return(height-(nodes.length-1)*nodePadding)/(0,_sumBy2.default)(nodes,getValue)})),d=0,maxDepth=depthTree.length;d<maxDepth;d++)for(var i=0,len=depthTree[d].length;i<len;i++){var node=depthTree[d][i];node.y=i;node.dy=node.value*yRatio}return links.map(function(link){return _objectSpread({},link,{dy:getValue(link)*yRatio})})},resolveCollisions=function(depthTree,height,nodePadding){for(var i=
0,len=depthTree.length;i<len;i++){var nodes=depthTree[i],n=nodes.length;nodes.sort(ascendingY);for(var y0=0,j=0;j<n;j++){var node=nodes[j];y0-=node.y;0<y0&&(node.y+=y0);y0=node.y+node.dy+nodePadding}y0=height+nodePadding;for(--n;0<=n;n--)if(j=nodes[n],y0=j.y+j.dy+nodePadding-y0,0<y0)j.y-=y0,y0=j.y;else break}},updateYOfLinks=function(tree,links){for(var i=0,len=tree.length;i<len;i++){var node=tree[i],sy=0,ty=0;node.targetLinks.sort(function(a,b){return tree[links[a].target].y-tree[links[b].target].y});
node.sourceLinks.sort(function(a,b){return tree[links[a].source].y-tree[links[b].source].y});for(var j=0,tLen=node.targetLinks.length;j<tLen;j++){var link=links[node.targetLinks[j]];link&&(link.sy=sy,sy+=link.dy)}sy=0;for(j=node.sourceLinks.length;sy<j;sy++)if(tLen=links[node.sourceLinks[sy]])tLen.ty=ty,ty+=tLen.dy}};require=(0,_PureRender.default)(_class=(_temp=_class2=function(_Component){function Sankey(props){if(!(this instanceof Sankey))throw new TypeError("Cannot call a class as a function");
var _this=_getPrototypeOf(Sankey).call(this,props);if(!_this||"object"!==_typeof(_this)&&"function"!==typeof _this){if(void 0===this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");_this=this}_this.state=_this.constructor.createDefaultState(props);return _this}_inherits(Sankey,_Component);_createClass(Sankey,[{key:"componentWillReceiveProps",value:function(nextProps){var _this$props=this.props,width=_this$props.width,height=_this$props.height,margin=_this$props.margin,
iterations=_this$props.iterations,nodeWidth=_this$props.nodeWidth,nodePadding=_this$props.nodePadding,nameKey=_this$props.nameKey;nextProps.data===_this$props.data&&nextProps.width===width&&nextProps.height===height&&(0,_PureRender.shallowEqual)(nextProps.margin,margin)&&nextProps.iterations===iterations&&nextProps.nodeWidth===nodeWidth&&nextProps.nodePadding===nodePadding&&nextProps.nameKey===nameKey||this.setState(this.constructor.createDefaultState(nextProps))}},{key:"handleMouseEnter",value:function(el,
type,e){var _this$props2=this.props,onMouseEnter=_this$props2.onMouseEnter;_this$props2=_this$props2.children;(0,_ReactUtils.findChildByType)(_this$props2,_Tooltip.default)?this.setState({activeElement:el,activeElementType:type,isTooltipActive:!0},function(){onMouseEnter&&onMouseEnter(el,type,e)}):onMouseEnter&&onMouseEnter(el,type,e)}},{key:"handleMouseLeave",value:function(el,type,e){var _this$props3=this.props,onMouseLeave=_this$props3.onMouseLeave;_this$props3=_this$props3.children;(0,_ReactUtils.findChildByType)(_this$props3,
_Tooltip.default)?this.setState({isTooltipActive:!1},function(){onMouseLeave&&onMouseLeave(el,type,e)}):onMouseLeave&&onMouseLeave(el,type,e)}},{key:"renderLinks",value:function(links,nodes){var _this2=this,_this$props4=this.props,linkCurvature=_this$props4.linkCurvature,linkContent=_this$props4.link;_this$props4=_this$props4.margin;var top=_this$props4.top||0,left=_this$props4.left||0;return _react.default.createElement(_Layer.default,{className:"recharts-sankey-links",key:"recharts-sankey-links"},
links.map(function(link,i){var sourceRelativeY=link.sy,targetRelativeY=link.ty,linkWidth=link.dy,source=nodes[link.source],target=nodes[link.target],sourceX=source.x+source.dx+left,targetX=target.x+left,interpolationFunc=interpolationGenerator(sourceX,targetX),sourceControlX=interpolationFunc(linkCurvature);interpolationFunc=interpolationFunc(1-linkCurvature);link=_objectSpread({sourceX:sourceX,targetX:targetX,sourceY:source.y+sourceRelativeY+linkWidth/2+top,targetY:target.y+targetRelativeY+linkWidth/
2+top,sourceControlX:sourceControlX,targetControlX:interpolationFunc,sourceRelativeY:sourceRelativeY,targetRelativeY:targetRelativeY,linkWidth:linkWidth,index:i,payload:_objectSpread({},link,{source:source,target:target})},(0,_ReactUtils.getPresentationAttributes)(linkContent));sourceRelativeY={onMouseEnter:_this2.handleMouseEnter.bind(_this2,link,"link"),onMouseLeave:_this2.handleMouseLeave.bind(_this2,link,"link")};return _react.default.createElement(_Layer.default,_extends({key:"link".concat(i)},
sourceRelativeY),_this2.constructor.renderLinkItem(linkContent,link))}))}},{key:"renderNodes",value:function(nodes){var _this3=this,_this$props5=this.props,nodeContent=_this$props5.node;_this$props5=_this$props5.margin;var top=_this$props5.top||0,left=_this$props5.left||0;return _react.default.createElement(_Layer.default,{className:"recharts-sankey-nodes",key:"recharts-sankey-nodes"},nodes.map(function(node,i){var x=node.x,y=node.y,dx=node.dx,dy=node.dy;node=_objectSpread({},(0,_ReactUtils.getPresentationAttributes)(nodeContent),
{x:x+left,y:y+top,width:dx,height:dy,index:i,payload:node});x={onMouseEnter:_this3.handleMouseEnter.bind(_this3,node,"node"),onMouseLeave:_this3.handleMouseLeave.bind(_this3,node,"node")};return _react.default.createElement(_Layer.default,_extends({key:"node".concat(i)},x),_this3.constructor.renderNodeItem(nodeContent,node))}))}},{key:"renderTooltip",value:function(){var _this$props6=this.props,children=_this$props6.children,width=_this$props6.width,height=_this$props6.height,nameKey=_this$props6.nameKey;
children=(0,_ReactUtils.findChildByType)(children,_Tooltip.default);if(!children)return null;var _this$state=this.state;_this$props6=_this$state.isTooltipActive;var activeElement=_this$state.activeElement;_this$state=_this$state.activeElementType;width={x:0,y:0,width:width,height:height};height=activeElement?"node"===_this$state?{x:activeElement.x+activeElement.width/2,y:activeElement.y+activeElement.height/2}:{x:(activeElement.sourceX+activeElement.targetX)/2,y:(activeElement.sourceY+activeElement.targetY)/
2}:defaultCoordinateOfTooltip;if(activeElement){var payload=activeElement.payload;"node"===_this$state?nameKey=[{payload:activeElement,name:(0,_ChartUtils.getValueByDataKey)(payload,nameKey,""),value:(0,_ChartUtils.getValueByDataKey)(payload,"value")}]:payload.source&&payload.target?(_this$state=(0,_ChartUtils.getValueByDataKey)(payload.source,nameKey,""),nameKey=(0,_ChartUtils.getValueByDataKey)(payload.target,nameKey,""),nameKey=[{payload:activeElement,name:"".concat(_this$state," - ").concat(nameKey),
value:(0,_ChartUtils.getValueByDataKey)(payload,"value")}]):nameKey=[]}else nameKey=[];return _react.default.cloneElement(children,{viewBox:width,active:_this$props6,coordinate:height,label:"",payload:nameKey})}},{key:"render",value:function(){if(!(0,_ReactUtils.validateWidthHeight)(this))return null;var _this$props7=this.props,width=_this$props7.width,height=_this$props7.height,className=_this$props7.className,style=_this$props7.style,children=_this$props7.children,others=_objectWithoutProperties(_this$props7,
["width","height","className","style","children"]),_this$state2=this.state;_this$props7=_this$state2.links;_this$state2=_this$state2.nodes;others=(0,_ReactUtils.getPresentationAttributes)(others);return _react.default.createElement("div",{className:(0,_classnames.default)("recharts-wrapper",className),style:_objectSpread({},style,{position:"relative",cursor:"default",width:width,height:height})},_react.default.createElement(_Surface.default,_extends({},others,{width:width,height:height}),(0,_ReactUtils.filterSvgElements)(children),
this.renderLinks(_this$props7,_this$state2),this.renderNodes(_this$state2)),this.renderTooltip())}}],[{key:"createDefaultState",value:function(props){var margin=props.margin,data=props.data,height=props.height-(margin&&margin.top||0)-(margin&&margin.bottom||0),iterations=props.iterations,nodePadding=props.nodePadding,links=data.links;props=getNodesTree(data,props.width-(margin&&margin.left||0)-(margin&&margin.right||0),props.nodeWidth).tree;margin=[];data=0;for(var len=props.length;data<len;data++){var node=
props[data];margin[node.depth]||(margin[node.depth]=[]);margin[node.depth].push(node)}links=updateYOfTree(margin,height,nodePadding,links);resolveCollisions(margin,height,nodePadding);for(len=data=1;len<=iterations;len++){node=props;for(var depthTree=margin,links$jscomp$0=links,alpha=data*=.99,i=depthTree.length-1;0<=i;i--)for(var nodes=depthTree[i],j=0,len$jscomp$0=nodes.length;j<len$jscomp$0;j++){var node$jscomp$0=nodes[j];if(node$jscomp$0.targetLinks.length){var targetSum=getSumOfIds(links$jscomp$0,
node$jscomp$0.targetLinks);targetSum=getSumWithWeightedTarget(node,links$jscomp$0,node$jscomp$0.targetLinks)/targetSum;node$jscomp$0.y+=(targetSum-centerY(node$jscomp$0))*alpha}}resolveCollisions(margin,height,nodePadding);node=props;depthTree=margin;links$jscomp$0=links;alpha=data;i=0;for(nodes=depthTree.length;i<nodes;i++)for(j=depthTree[i],len$jscomp$0=0,node$jscomp$0=j.length;len$jscomp$0<node$jscomp$0;len$jscomp$0++)if(targetSum=j[len$jscomp$0],targetSum.sourceLinks.length){var sourceSum=getSumOfIds(links$jscomp$0,
targetSum.sourceLinks);sourceSum=getSumWithWeightedSource(node,links$jscomp$0,targetSum.sourceLinks)/sourceSum;targetSum.y+=(sourceSum-centerY(targetSum))*alpha}resolveCollisions(margin,height,nodePadding)}updateYOfLinks(props,links);return{activeElement:null,activeElementType:null,isTooltipActive:!1,nodes:props,links:links}}},{key:"renderLinkItem",value:function(option,props){if(_react.default.isValidElement(option))return _react.default.cloneElement(option,props);if((0,_isFunction2.default)(option))return option(props);
option=props.sourceX;var sourceY=props.sourceY,sourceControlX=props.sourceControlX,targetX=props.targetX,targetY=props.targetY,targetControlX=props.targetControlX,linkWidth=props.linkWidth;props=_objectWithoutProperties(props,"sourceX sourceY sourceControlX targetX targetY targetControlX linkWidth".split(" "));return _react.default.createElement("path",_extends({className:"recharts-sankey-link",d:"\n          M".concat(option,",").concat(sourceY,"\n          C").concat(sourceControlX,",").concat(sourceY,
" ").concat(targetControlX,",").concat(targetY," ").concat(targetX,",").concat(targetY,"\n        "),fill:"none",stroke:"#333",strokeWidth:linkWidth,strokeOpacity:"0.2"},(0,_ReactUtils.getPresentationAttributes)(props)))}},{key:"renderNodeItem",value:function(option,props){return _react.default.isValidElement(option)?_react.default.cloneElement(option,props):(0,_isFunction2.default)(option)?option(props):_react.default.createElement(_Rectangle.default,_extends({className:"recharts-sankey-node",fill:"#0088fe",
fillOpacity:"0.8"},props))}}]);return Sankey}(_react.Component),_class2.displayName="Sankey",_class2.propTypes=_objectSpread({},_ReactUtils.PRESENTATION_ATTRIBUTES,_ReactUtils.EVENT_ATTRIBUTES,{nameKey:global.default.oneOfType([global.default.string,global.default.number,global.default.func]),dataKey:global.default.oneOfType([global.default.string,global.default.number,global.default.func]),width:global.default.number,height:global.default.number,data:global.default.shape({nodes:global.default.array,
links:global.default.arrayOf(global.default.shape({target:global.default.number,source:global.default.number,value:global.default.number}))}),nodePadding:global.default.number,nodeWidth:global.default.number,linkCurvature:global.default.number,iterations:global.default.number,node:global.default.oneOfType([global.default.object,global.default.element,global.default.func]),link:global.default.oneOfType([global.default.object,global.default.element,global.default.func]),style:global.default.object,
className:global.default.string,children:global.default.oneOfType([global.default.arrayOf(global.default.node),global.default.node]),margin:global.default.shape({top:global.default.number,right:global.default.number,bottom:global.default.number,left:global.default.number})}),_class2.defaultProps={nodePadding:10,nodeWidth:10,nameKey:"name",dataKey:"value",linkCurvature:.5,iterations:32,margin:{top:5,right:5,bottom:5,left:5}},_temp))||_class;exports.default=require}
//# sourceMappingURL=module$node_modules$recharts$lib$chart$Sankey.js.map
